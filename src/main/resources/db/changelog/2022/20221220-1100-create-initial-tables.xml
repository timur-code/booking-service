<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.0.xsd">
    <changeSet id="20221220-1100-create-initial-tables" author="timur_umurzakov">
        <sql>
            <![CDATA[
            create table bookings
            (
                id         int8 generated by default as identity,
                time_start timestamp,
                user_uuid  uuid,
                primary key (id)
            );


            create table bookings_menu_item_list
            (
                booking_id        int8 not null,
                menu_item_list_id int8 not null
            );


            create table menu_items
            (
                id          int8 generated by default as identity,
                description varchar(255),
                name        varchar(255),
                primary key (id)
            );


            create table menu_item_images
            (
                menu_item_id int8 not null,
                images       varchar(255)
            );


            create table menus
            (
                id          int8 generated by default as identity,
                description varchar(255),
                language    varchar(255),
                name        varchar(255),
                primary key (id)
            );


            create table menus_menu_items
            (
                menu_id       int8 not null,
                menu_items_id int8 not null
            );


            create table restaurants
            (
                id          int8 generated by default as identity,
                name        varchar(255),
                user_uuid   varchar(255),
                description varchar(255),
                primary key (id)
            );


            create table restaurants_bookings
            (
                restaurant_id int8 not null,
                bookings_id   int8 not null
            );


            create table restaurants_menu_list
            (
                restaurant_id int8 not null,
                menu_list_id  int8 not null
            );


            create table restaurants_restaurant_list
            (
                franchise_id       int8 not null,
                restaurant_list_id int8 not null
            );


            alter table if exists menus_menu_items
                add constraint UK_niaeb7urtvckqxkxxk1bpn8lu unique (menu_items_id);


            alter table if exists restaurants_bookings
                add constraint UK_4ussjosr9lhf62mi78ubdvr43 unique (bookings_id);


            alter table if exists restaurants_menu_list
                add constraint UK_lxjqk4g14023ygxwdp7slo52j unique (menu_list_id);


            alter table if exists restaurants_restaurant_list
                add constraint UK_kp2a62yiag0yqarlu4gmpducq unique (restaurant_list_id);


            alter table if exists bookings_menu_item_list
                add constraint FK3gnku8arnrk84gpbenopw0ukl
                foreign key (menu_item_list_id)
                references menu_items;


            alter table if exists bookings_menu_item_list
                add constraint FK7d8q5spkodxrl6kn4d5pago1l
                foreign key (booking_id)
                references bookings;


            alter table if exists menu_item_images
                add constraint FKtll3o77n7xar2fnw7elg34ntm
                foreign key (menu_item_id)
                references menu_items;


            alter table if exists menus_menu_items
                add constraint FK8p8jgldjm9thflw0v98dp5616
                foreign key (menu_items_id)
                references menu_items;


            alter table if exists menus_menu_items
                add constraint FKrhtkns8a0idpvdldjgm16rvi1
                foreign key (menu_id)
                references menus;


            alter table if exists restaurants_bookings
                add constraint FKr2gf9l128xuc76x1b1jdch0d6
                foreign key (bookings_id)
                references bookings;


            alter table if exists restaurants_bookings
                add constraint FK6jf796q202gehotsnevxtj9o2
                foreign key (restaurant_id)
                references restaurants;


            alter table if exists restaurants_menu_list
                add constraint FK6yiqbby2t9b8tkcvjba4dk9x
                foreign key (menu_list_id)
                references menus;


            alter table if exists restaurants_menu_list
                add constraint FKh7etkscylsfl62pc4ia88me3k
                foreign key (restaurant_id)
                references restaurants;


            alter table if exists restaurants_restaurant_list
                add constraint FKtign09fys39qd9jeoc95ak8j5
                foreign key (restaurant_list_id)
                references restaurants;


            alter table if exists restaurants_restaurant_list
                add constraint FKd6v0emsgbu8v9e9bq4tlby1vy
                foreign key (franchise_id)
                references restaurants;
            ]]>
        </sql>
    </changeSet>
</databaseChangeLog>
